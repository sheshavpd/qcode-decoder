!function(t,e){"object"==typeof exports?module.exports=e(require("../build/qrcode")):t.QCodeDecoder=e(qrcode)}(this,function(t){"use strict";function e(){if(!(this instanceof e))return new e;this.timerCapture=null,this.canvasElem=null,this.stream=null,this.videoConstraints={video:!0,audio:!1}}return e.prototype.isCanvasSupported=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},e.prototype.hasGetUserMedia=function(){return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,!!navigator.getUserMedia},e.prototype._prepareCanvas=function(e){return this.canvasElem||(this.canvasElem=document.createElement("canvas"),this.canvasElem.style.width=e.videoWidth+"px",this.canvasElem.style.height=e.videoHeight+"px",this.canvasElem.width=e.videoWidth,this.canvasElem.height=e.videoHeight),t.setCanvasElement(this.canvasElem),this},e.prototype._captureToCanvas=function(e,i,r){if(this.timerCapture&&clearTimeout(this.timerCapture),e.videoWidth&&e.videoHeight){this.canvasElem||this._prepareCanvas(e);var o=this.canvasElem.getContext("2d");o.clearRect(0,0,e.videoWidth,e.videoHeight),o.drawImage(e,0,0,e.videoWidth,e.videoHeight);try{if(i(null,t.decode()),r)return}catch(t){"Couldn't find enough finder patterns"!==t&&i(new Error(t))}}this.timerCapture=setTimeout(function(){this._captureToCanvas.call(this,e,i,r)}.bind(this),500)},e.prototype.decodeFromCamera=function(t,e,i){var r=(this.stop(),this);return this.hasGetUserMedia()||e(new Error("Couldn't get video from camera")),navigator.getUserMedia(this.videoConstraints,function(o){t.src=window.URL.createObjectURL(o),r.videoElem=t,r.stream=o,r.videoDimensions=!1,setTimeout(function(){r._captureToCanvas.call(r,t,e,i)},500)},e),this},e.prototype.decodeFromVideo=function(t,e,i){return setTimeout(function(){this._captureToCanvas.call(this,t,e,i)}.bind(this),500),this},e.prototype.decodeFromImage=function(e,i){if(+e.nodeType>0&&!e.src)throw new Error("The ImageElement must contain a src");return e=e.src?e.src:e,t.decode(e,i),this},e.prototype.stop=function(){return this.stream&&(this.stream.stop(),this.stream=void 0),this.timerCapture&&(clearTimeout(this.timerCapture),this.timerCapture=void 0),this},e.prototype.setSourceId=function(t){return this.videoConstraints.video=!t||{optional:[{sourceId:t}]},this},e.prototype.getVideoSources=function(t){var e=[];return MediaStreamTrack&&MediaStreamTrack.getSources?(MediaStreamTrack.getSources(function(i){i.forEach(function(t){"video"===t.kind&&e.push(t)}),t(null,e)}),this):t(new Error("Current browser doest not support MediaStreamTrack.getSources"))},e});
